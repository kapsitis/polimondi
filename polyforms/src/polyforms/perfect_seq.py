# k --> k+4 (where k mod 4 == 3)
# 11, 15, 19, 23, 27, 31, ...
SEQ_4_3_A = [
    'ACBDFEDFEAC',
    'ACBCDFEFDFEFACB',
    'ACBCBDFEFEDFEFEACBC',
    'ACBCBCDFEFEFDFEFEFACBCB',
    'ACBCBCBDFEFEFEDFEFEFEACBCBC',
    'ACBCBCBCDFEFEFEFDFEFEFEFACBCBCB'
]

# k --> k+4 (where k mod 4 = 3)
# 15, 19, 23, 27, 31, ...
SEQ_4_3_B = [
    'ABCBDEFEDEFEABC',
    'ABCBCDEFEFDEFEFABCB',
    'ABCBCBDEFEFEDEFEFEABCBC',
    'ABCBCBCDEFEFEFDEFEFEFABCBCB',
    'ABCBCBCBDEFEFEFEDEFEFEFEABCBCBC'
]

# k --> k+4 (where k mod 4 = 1)
# 17, 21, 25, 29, 33, 37, ...
SEQ_4_1_A = [
    'ACBCDEAEFDFEFABDB',
    'ACBCBDEAEFEDFEFEABDBC',
    'ACBCBCDEAEFEFDFEFEFABDBCB',
    'ACBCBCBDEAEFEFEDFEFEFEABDBCBC',
    'ACBCBCBCDEAEFEFEFDFEFEFEFABDBCBCB',
    'ACBCBCBCBDEAEFEFEFEDFEFEFEFEABDBCBCBC'
]

# k --> k+8 (where k mod 8 = 7)
# 7, 15, 23, 31, ...
SEQ_8_7_A = [
    'ACDEFAC',
    'ACDCDFAEFAFACDC',
    'ACDCDCDFAFAEFAFAFACDCDC',
    'ACDCDCDCDFAFAFAEFAFAFAFACDCDCDC'
]

# k --> k+8 (where k mod 8 = 7)
# 7, 15, 23, ...
SEQ_8_7_B = [
    'ACBCDEFEAEFEACB',
    'ACBCBCDEFEFEAEFEFEACBCB',
    'ACBCBCBCDEFEFEFEAEFEFEFEACBCBCB',
    'ACBCBCBCBCDEFEFEFEFEAEFEFEFEFEACBCBCBCB'
]

# k --> k+8 (where k mod 8 = 7)
# 7, 15, 23, ...
SEQ_8_7_C = [
    'ACBCDFEFDFEFACB',
    'ACBCBCDFEFEFDFEFEFACBCB',
    'ACBCBCBCDFEFEFEFDFEFEFEFACBCBCB',
    'ACBCBCBCBCDFEFEFEFEFDFEFEFEFEFACBCBCBCB'
]

# k --> k+8 (where k mod 8 = 7)
# 7, 15, 23, ...
SEQ_8_7_D = [
    'ABCBDEFEDEFEABC',
    'ABCBCBDEFEFEDEFEFEABCBC',
    'ABCBCBCBDEFEFEFEDEFEFEFEABCBCBC',
    'ABCBCBCBCBDEFEFEFEFEDEFEFEFEFEABCBCBCBC'
]

# k --> k+8 (where k mod 8 = 5)
# 5, 13, 21, ...
SEQ_8_5_A = [
    'ACACDEFDFDFAB',
    'ACACACDFDEFDFDFDFACAB',
    'ACACACACDFDFDEFDFDFDFDFACACAB'
]

# k --> k+8 (where k mod 8 = 5)
# 21, 29, 37
SEQ_8_5_B = [
    'ABCBCDEAEFEDEFEFABDBC',
    'ABCBCBCDEAEFEFEDEFEFEFABDBCBC',
    'ABCBCBCBCDEAEFEFEFEDEFEFEFEFABDBCBCBC',
    'ABCBCBCBCBCDEAEFEFEFEFEDEFEFEFEFEFABDBCBCBCBC'
]

# k --> k+8 (where k mod 8 = 3)
# 11, 19, 27, 35
SEQ_8_3_A = [
    'ABDCEFDEAFB',
    'ABDBDCEAEFDFDFAFBDB',
    'ABDBDBDCEAEAEFDFDFAEAFBDBDB',
    'ABDBDBDBDCEAEAEAEFDFDFAEAEAFBDBDBDB'
]

# k --> k+8 (where k mod 8 = 3)
# 11, 19, 27, 35
SEQ_8_3_B = [
    'ABCDFEDEFAC',
    'ABCBCDFEFEDEFEFACBC',
    'ABCBCBCDFEFEFEDEFEFEFACBCBC',
    'ABCBCBCBCDFEFEFEFEDEFEFEFEFACBCBCBC'
]


# k --> k+8 (where k mod 8 = 3)
# 11, 19, 27, 35
SEQ_8_3_C = [
    'ABCDEFDFEAC',
    'ABCBCDEFEFDFEFEACBC',
    'ABCBCBCDEFEFEFDFEFEFEACBCBC',
    'ABCBCBCBCDEFEFEFEFDFEFEFEFEACBCBCBC'
]

# k --> k+8 (where k mod 8 = 3)
# 11, 19, 27, 35
SEQ_8_3_D = [
    'ACBDFEDEFAB',
    'ACBCBDFEFEDEFEFABCB',
    'ACBCBCBDFEFEFEDEFEFEFABCBCB',
    'ACBCBCBCBDFEFEFEFEDEFEFEFEFABCBCBCB'
]

# k --> k+8 (where k mod 8 = 3)
# 11, 19, 27, 35
SEQ_8_3_E = [
    'ACBDEFDFEAB',
    'ACBCBDEFEFDFEFEABCB',
    'ACBCBCBDEFEFEFDFEFEFEABCBCB',
    'ACBCBCBCBDEFEFEFEFDFEFEFEFEABCBCBCB'
]

# k --> k+8 (where k mod 8 = 1)
# 17, 25, 33, ...
SEQ_8_1_A = [
    'ACACEDFDFEACACDBF',
    'ACACACEDFDFDFDFEACACACDBF',
    'ACACACACEDFDFDFDFDFDFEACACACACDBF',
    'ACACACACACEDFDFDFDFDFDFDFDFEACACACACACDBF'
]

# k --> k+8 (where k mod 8 = 1)
# 17, 25, 33, ...
SEQ_8_1_B = [
    'ACBCDEAFEDFEFABDC',
    'ACBCBCDEAFEFEDFEFEFABDCBC',
    'ACBCBCBCDEAFEFEFEDFEFEFEFABDCBCBC',
    'ACBCBCBCBCDEAFEFEFEFEDFEFEFEFEFABDCBCBCBC'
]

# k --> k+6 (where k mod 6 = 5)
# 23, 29, 35, 41, 47
SEQ_6_5_A = [
    'ACBACBDFEDFEDFEDFEACBAC',
    'ABCBACBDFEDFEDEFEDEFEACBACACB',
    'ACBACBACBDFEDFEDFEDFEDFEDFEACBACBAC',
    'ABCBACBACBDFEDFEDFEDEFEDEFEDFEACBACBACACB',
    'ACBACBACBACBDFEDFEDFEDFEDFEDFEDFEDFEACBACBACBAC'
]

# k --> k+6 (where k mod 6 = 5)
SEQ_6_5_B = [
    'ACBACBDFEDFEDFEDFEACBAC',
    'ACBABCBDFEDFDFEDFEDEFEACBACAC',
    'ACBACBACBDFEDFDEFEDFEDFEDFEACBACABC',
    'ACBABCBACBDFEDFDFEDFEDFEDEFEDFEACBACACBAC',
    'ACBACBACBACBDFEDFDEFEDFEDFEDFEDFEDFEACBACABCBAC',
    'ACBABCBACBACBDFEDFDFEDFEDFEDFEDEFEDFEDFEACBACACBACBAC',
]


class PSequence:
    def __init__(self, template, rules):
        self.template = template
        self.rules = rules
        # if param is not None:

    # Izrēķina un atgriež polimondu virknes n-to locekli
    # Pašu pirmo (self.template) uzskatām par 0-to virknes locekli
    def get(self, n):
        # Sākumstāvoklis - īsākais polimonds ar punktiņiem
        current = self.template
        # Ievietojamie fragmenti var būt ikreiz tie paši vai arī veidot 2 gājienu ciklu
        cycle = len(self.rules)
        # Atkārto n reizes
        for i in range(0, n):
            current_rulelist = self.rules[i % cycle]
            list_s = current.split('.')
            next = [list_s[0]]
            for idx,seq in enumerate(current_rulelist):
                next.append(seq + list_s[idx+1])
            current = ''.join(next)
        return current.replace('.', '')





# This class returns known inductive sequences of perfect polyiamonds
class PerfectSeq:
    # all_sequences = None
    pseq = {}

    @classmethod
    def dict_init(cls):
        if len(cls.pseq) > 0:
            return # already initialized
        cls.pseq['SEQ_4_3_A'] = PSequence('ACB.DFE.DFE.AC.',[['C.','F.','F.','B.'],['B.','E.','E.','C.']])
        cls.pseq['SEQ_4_3_B'] = PSequence('ABCB.DEFE.DEFE.ABC.',[['C.','F.','F.','B.'],['B.','E.','E.','C.']])
        cls.pseq['SEQ_4_1_A'] = PSequence('ACBC.DEAEF.DFEF.ABDB.',[['B.','E.','E.','C.'],['C.','F.','F.','B.']])
        cls.pseq['SEQ_8_7_A'] = PSequence('ACD..EF.AC.',[['CD.','FA.','AF.','DC.']])
        cls.pseq['SEQ_8_7_B'] = PSequence('ACBC.DEFE.AEFE.ACB.',[['BC.','FE.','FE.','CB.']])
        cls.pseq['SEQ_8_7_C'] = PSequence('ACBC.DFEF.DFEF.ACB.',[['BC.','EF.','EF.','CB.']])
        cls.pseq['SEQ_8_7_D'] = PSequence('ABCB.DEFE.DEFE.ABC.',[['CB.','FE.','FE.','BC.']])
        cls.pseq['SEQ_8_5_A'] = PSequence('ACAC..DEFDFD.F.AB',[['AC.','DF.','FD.','AC.']])
        cls.pseq['SEQ_8_5_B'] = PSequence('ABCBC.DEAEFE.DEFEF.ABDBC.',[['BC.','FE.','EF.','BC.']])
        cls.pseq['SEQ_8_3_A'] = PSequence('ABDBD.CEAE.FDFDFA.FBDB.',[['BD.','AE.','EA.','DB.']])
        cls.pseq['SEQ_8_3_B'] = PSequence('ABC.DFE.DEF.AC.',[['BC.','FE.','EF.','BC.']])
        cls.pseq['SEQ_8_3_C'] = PSequence('ABC.DEF.DFE.AC.',[['BC.','EF.','FE.','BC.']])
        cls.pseq['SEQ_8_3_D'] = PSequence('ACB.DFE.DEF.AB.',[['CB.','FE.','EF.','CB.']])
        cls.pseq['SEQ_8_3_E'] = PSequence('ACB.DEF.DFE.AB.',[['CB.','EF.','FE.','CB.']])
        cls.pseq['SEQ_8_1_A'] = PSequence('ACAC.EDFDF.EACAC.DBF',[['AC.','DFDF.','AC.']])
        cls.pseq['SEQ_8_1_B'] = PSequence('ACBC.DEAFE.DFEF.ABDC.',[['BC.','FE.','EF.','BC.']])
        cls.pseq['SEQ_6_5_B'] = PSequence('ACBA.B.CBDFEDFD.FEDFED.E.FEACBACA.C',[['.C','A','.E.','.F','D','.B.'],['.B.','.F','D','.E.','.C','A']])

    def __init__(self):
        self.dict_init()

    # Get the names of all sequences
    def get_names(self):
        return self.pseq.keys()

